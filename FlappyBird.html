<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bird</title> 

    <style>
        body {
           margin: 0;
           padding: 0; 
           display: flex; 
           align-items: center; 
           justify-content: center; 
           height: 100vh; 
           background-color: rgb(154, 224, 236); 
       }

  canvas {border: 1px solid rgb(21, 75, 48)
  }
       
   </style>
</head>
<body>
    <div></div>
    <canvas></canvas>
<script>

    const canvas = document.querySelector("canvas");
    var ctx = canvas.getContext("2d");

    canvas.width = 800;
    canvas.height = 600;
    const cw = canvas.width;
    const ch = canvas.height;


    const bird = {
        size: 30,
        x: 10,
        y: (ch/2 - 15),
    }

    const pipe = [
        {x: 800, y: 0, w: 50, h: 250},
        {x: 800, y: 350, w: 50, h: 250},
        {x: 1000, y: 0, w: 50, h: 250},
        {x: 1000, y: 350, w: 50, h: 250},
        {x: 1200, y: 0, w: 50, h: 250},
        {x: 1200, y: 350, w: 50, h: 250},
        {x: 1400, y: 0, w: 50, h: 250},
        {x: 1400, y: 350, w: 50, h: 250},
    ]
    
    let spacePressed = false;
    let angle = 0;
    let hue = 0;
    let frame = 0;
    let scroe = 0;
    let gameSpeed = 2;

    let gravity = 1;
    let velocity = 0;
    let lift = -10;



function background() {
        ctx.fillStyle = "green"
        ctx.fillRect(0, 0, cw, ch);
}

function drawBird() {
        ctx.clearRect(0, 0, cw, ch);
        ctx.fillStyle = "yellow";
        ctx.fillRect(bird.x, bird.y, bird.size, bird.size);
}

function gravityGame() {
        velocity += gravity;
        velocity *= 0.9;
        bird.y += velocity;

            if(bird.y + bird.size > ch) {
                bird.y = ch - bird.size;
                velocity = 0;
            }

            if(bird.y < 0) {
                bird.y = 0;
                velocity = 0;
            }
}

function gravityUp() {
        velocity = lift;  //-gravity*30
}

//const newPipe = {x: 800, y: 0, w: 50, h: 250};

function drawPipe() {
       
        for(var i = 0; i < pipe.length; i++) {

        ctx.fillStyle = "green"
        ctx.fillRect(pipe[i].x, pipe[i].y, pipe[i].w, pipe[i].h);
        
        pipe[i].x -= 5;  

        }
 
        if(pipe[0].x <= -50) {
            pipe.push({x: 800, y: 0, w: 50, h: 250});
            pipe.push({x: 800, y: 350, w: 50, h: 250});
            pipe.shift();
            pipe.shift();
        }
}

function collisionPipe() {
    if(bird.x + bird.size >= pipe[0].x && bird.y >= pipe[0].y) {
        alert("lost");
    }

}




document.addEventListener("keydown", function(event) {
            if(event.keyCode == 32) {
                spacePressed = true;
                gravityUp();
            }       
});

document.addEventListener("keyup", function(event) {
            if(event.keyCode == 32) {
                spacePressed = false;
            }       
});






function draw() {
    background();
    drawBird();
    drawPipe();
}

function update() {
    gravityGame();
    collisionPipe()
}

function game() {
    draw();
    update();
}

    setInterval(game, 30);


    </script>
</body>
</html>
